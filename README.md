# MSP430g2553_VoltTrack
## 1.时钟
### 介绍
MSP430G2553的时钟模块是一个复杂而灵活的系统，它可以为CPU和片上外设提供不同的时钟源和输出。时钟模块主要包括以下几个部分：
### 时钟模块
四个时钟源：内部低速振荡器 (VLO)、外部低速时钟振荡器 (LFXT1)、外部高速时钟振荡器 (XT2)和数控时钟振荡器 (DCO)。这些时钟源可以通过配置相应的寄存器来选择和调节，以满足不同的功耗和精度要求。（我们用的MSP430G2553是没有XT2CLK时钟源的）

• LFXT1CLK：低频/高频振荡器，可与 32768Hz 的低频手表晶体或外部时钟源或者 400kHz 至 16MHz 范围内
的标准晶体、谐振器或外部时钟源一同使用。

• XT2CLK：可选高频振荡器，可与 400kHz 至 16MHz 范围内的标准晶体、谐振器或外部时钟源一同使用。

• DCOCLK：内部数控振荡器 (DCO)。

• VLOCLK：具有 12kHz 典型频率的内部超低功耗低频振荡器。

### 时钟输出
三个时钟输出：主系统时钟 (MCLK)、子系统时钟 (SMCLK)和辅助时钟 (ACLK)。这些时钟输出可以从任意一个时钟源获取，并可以进行进一步的分频，以适应不同的设备工作频率。MCLK为CPU提供运行时钟，SMCLK为高速设备提供高速时钟，ACLK为低速设备提供低速时钟。

• ACLK：辅助时钟。ACLK 是由软件选择来作为 LFXT1CLK 或 VLOCLK。ACLK 进行 1、2、4 或 8 分频。
ACLK 可由软件选作各个外围模块。

• MCLK：主时钟。可通过软件将 MCLK 选择为 LFXT1CLK、VLOCLK、XT2CLK（如果片上可用）或 
DCOCLK。MCLK 进行 1、2、4 或 8 分频。MCLK 用于 CPU 和系统。

• SMCLK：子主时钟。可通过软件将 SMCLK 选择为 LFXT1CLK、VLOCLK、XT2CLK（如果片上可用）或 
DCOCLK。SMCLK 进行 1、2、4 或 8 分频。可通过软件针对各个外设模块选择 SMCLK。

### 寄存器
-   四个时钟寄存器：DCOCTL、BCSCTL1、BCSCTL2和BCSCTL3。这些寄存器用于控制时钟源的选择、分频、开关和稳定性等参数。

### 频率点
官方校准好的频率点有1MHZ,8MHZ,12MHZ,16MHZ,用这些官方频率点可以获得一个比较稳定的频率，具体配置为:

> DCOCTL = CALDCO_16MHZ;
> BCSCTL1 = CALBC1_16MHZ;
> //可以把DCO频率设置为16MHZ
## 2.I/O中断
### 中断模块介绍
MSP430G2553的I/O中断模块是一个可以对P1和P2端口的8个引脚进行中断控制和处理的模块。而中断是一种特殊的事件，它可以打断CPU的正常执行流程，让CPU去处理更紧急的任务。中断可以由外部设备或内部程序产生，例如按键、定时器、串口等。当CPU检测到一个中断请求时，它会暂停当前的程序，保存现场，跳转到对应的中断服务函数执行，处理完毕后恢复现场，返回原来的程序继续执行。
### 中断相应的寄存器模块
-   P1IE和P2IE：这两个寄存器用于设置P1和P2端口的8个引脚的中断使能位。如果某一位为1，表示该引脚可以产生中断请求；如果为0，表示该引脚不产生中断请求。
-   P1IES和P2IES：这两个寄存器用于设置P1和P2端口的8个引脚的中断触发沿。如果某一位为1，表示该引脚在高电平到低电平的下降沿触发中断；如果为0，表示该引脚在低电平到高电平的上升沿触发中断。
-   P1IFG和P2IFG：这两个寄存器用于记录P1和P2端口的8个引脚的中断标志位。如果某一位为1，表示该引脚已经产生了一个中断请求，并等待CPU处理；如果为0，表示该引脚没有产生或已经处理过一个中断请求。
-   P1IV和P2IV：这两个寄存器用于记录P1和P2端口最高优先级的中断向量值。当CPU响应一个I/O中断时，它会自动读取这两个寄存器的值，并根据值跳转到相应的中断服务函数地址。同时，这两个寄存器也会自动清除相应的中断标志位。
### 具体使用方法

-   选择需要使用I/O中断功能的引脚，并将其配置为输入模式。
-   设置相应的P1IE或P2IE寄存器，使能该引脚的中断功能。
-   设置相应的P1IES或P2IES寄存器，选择该引脚的中断触发沿。
-   编写对应的中断服务函数，并在函数开头清除相应的P1IFG或P2IFG寄存器。
-   在主函数中开启全局中断，并进入低功耗模式等待中断发生。
